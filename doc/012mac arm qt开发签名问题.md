## 移除标识符
通过 HTTP 协议下载的文件可能会被 macOS 系统标记为来自不明来源，进而触发安全提示。使用 xattr -rd com.apple.quarantine ./ 可以移除这些标识符，从而避免频繁的安全提示

---

## 签名要求
在 macOS 上使用 ARM 架构（如 Apple Silicon 芯片）开发应用时，签名要求有所不同，尤其是当你试图通过终端启动应用时。
- 本地签名：如果你通过终端启动未签名的应用，macOS 可能会阻止启动，提示应用来自不明开发者。因此，应用程序通常需要进行本地签名，至少要通过开发者自签名，才能通过终端或 Finder 启动而不触发安全警告。
- 调试器启动：当你使用 Xcode 或其他调试工具启动应用时，通常不需要提前签名。调试工具会自动处理签名和权限问题，让你能够直接调试和运行未签名的应用。

使用以下命令对应用进行本地签名：
```
codesign --deep --force --sign - /path/to/your/app
```
这里的 - 代表使用系统的自签名证书。这种方式足以让 macOS 认可应用并允许从终端启动。

---

## 签名失败分析
在进行代码签名时，如果你收到“unsealed contents present in the root directory of an embedded framework”的错误提示，这意味着在嵌入式框架的根目录中存在未封装的内容，这些内容没有被正确处理或打包。这种情况通常会导致签名失败，因为 macOS 的代码签名要求所有文件都必须正确封装在应用包中。

失败原因：
- 未封装的文件：嵌入式框架的根目录中可能存在未封装的文件或目录，这些文件可能是临时文件、日志文件或者其他不属于框架的文件。
- 不正确的打包方式：框架在打包时没有按照预期的目录结构，导致不符合签名要求。

解决方法：
- 检查框架的根目录：
    - 打开框架目录，检查根目录下是否有不属于框架的文件或目录。这些文件可能是隐藏文件，使用 ls -a 命令可以查看所有文件。
    - 删除或移动这些不必要的文件，确保框架的根目录只包含框架的内容。

- 重新打包框架：
    - 确保框架在打包时遵循正确的目录结构。框架的根目录应该只包含 Info.plist 文件和 Resources 目录（如果有），以及 Versions 目录（对于 macOS 框架）。
    - 重新打包并确保没有多余的文件混入框架中。

- 重新签名：

---

## 检查签名状态
使用以下命令来验证签名是否成功
```
codesign --verify --deep --strict /path/to/your/app
```

可以检查应用的签名状态和完整性
```
codesign --verify --deep --strict --verbose=2 /path/to/your/xxx.app

// 参数说明：
// --verify：验证签名。
// --deep：递归验证嵌入在 .app 包中的所有内容（如嵌入的框架、插件等）。
// --strict：使用更严格的验证规则来检查签名的完整性。
// --verbose=2：提供详细的输出，显示验证过程中的具体信息。
// --verbose=4：输出详细的检查过程，提供每个文件的签名状态。
// 如果签名验证成功，你会看到 valid on disk 和 satisfies its Designated Requirement 这样的信息。
```

使用 spctl 命令验证签名状态，spctl（Security Policy Control）命令可以验证应用是否符合 macOS 的安全政策，并且可以在系统中正常运行。
```
spctl --assess --type execute --verbose=2 /path/to/your/xxx.app

// 参数说明：
// --assess：评估应用的签名状态。
// --type execute：验证应用的可执行性签名状态。
// --verbose=2：提供详细的输出信息。
// 如果签名验证成功，通常会看到 accepted 的信息。
```

检查具体签名信息
```
codesign -dvvv /path/to/your/xxx.app
// -vvv：这个参数表示启用详细模式（verbose），并且输出的详细程度为三级。每增加一个 v，就会增加输出的详细程度。
// -v：输出基本的验证信息。
// -vv：输出更详细的验证信息，包括签名的附加信息。
// -vvv：输出最详细的信息，显示每个被检查的文件和更深入的签名信息。
```